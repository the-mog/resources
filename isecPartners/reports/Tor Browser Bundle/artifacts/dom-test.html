<html>
<head>
	<title>Tor Browser DOM Test</title>
</head>
<body>

<div style="text-align:center"><h1>TBB DOM Tests</h1></div>

<h2>Unexpected Objects</h2>
<p>These objects were not expected to be present in the Global Namespace. They should be carefully examined for security and privacy considerations.</p>
<div id="unexpectedNames"></div>

<h2>Unseen Objects</h2>
<p>These objects were expected to be present in the Global Namespace, but were not. They indicate some lack of understanding between how the browser is built and how the interfaceNamesInGlobalScope is defined.</p>
<div id="unseenNames"></div>

<h2>Expected Objects</h2>
<p>These objects were expected to be found, and were.</p>
<div style="font-size:smaller" id="seenNames"></div>

<script type="application/javascript">
var objectsIDontCareAbout = 
  [
    "interfaceNamesInGlobalScope",
    "objectsIDontCareAbout",
  	"Object",
    "Function",
    "eval",
    "window",
    "document",
    "undefined",
    "Boolean",
    "Date",
    "Math",
    "isNaN",
    "isFinite",
    "parseFloat",
    "parseInt",
    "NaN",
    "Infinity",
    "Number",
    "String",
    "escape",
    "unescape",
    "uneval",
    "decodeURI",
    "encodeURI",
    "decodeURIComponent",
    "encodeURIComponent",
    "Error",
    "InternalError",
    "EvalError",
    "RangeError",
    "ReferenceError",
    "SyntaxError",
    "TypeError",
    "URIError",
    "RegExp",
    "Iterator",
    "StopIteration",
    "Int8Array",
    "Uint8Array",
    "Int16Array",
    "Uint16Array",
    "Int32Array",
    "Uint32Array",
    "Float32Array",
    "Float64Array",
    "Uint8ClampedArray",
    "DataView",
    "ArrayBuffer",
    "WeakMap",
    "Map",
    "Set",
    "Proxy",
    "Image"
  ];
//Taken from Tor Browser's dom/tests/mochitest/general/test_interfaces.html
var interfaceNamesInGlobalScope =
  [
    "AnimationEvent",
    "Array",
    "AsyncScrollEventDetail",
    "Attr",
    "BarProp",
    "BatteryManager",
    "BeforeUnloadEvent",
    "Blob",
    "BlobEvent",
    "BoxObject",
    "CameraCapabilities",
    "CameraControl",
    "CameraManager",
    "CanvasGradient",
    "CanvasPattern",
    "CanvasRenderingContext2D",
    "CDATASection",
    "CharacterData",
    "ChromeWindow",
    "ClientInformation",
    "ClientRect",
    "ClientRectList",
    "ClipboardEvent",
    "CloseEvent",
    "CommandEvent",
    "Comment",
    "CompositionEvent",
    "Contact",
    "ContactManager",
    "Controllers",
    "Counter",
    "CRMFObject",
    "Crypto",
    "CryptoDialogs",
    "CSS2Properties",
    "CSSCharsetRule",
    "CSSConditionRule",
    "CSSFontFaceRule",
    "CSSFontFeatureValuesRule",
    "CSSGroupingRule",
    "CSSImportRule",
    "CSSMediaRule",
    "CSSMozDocumentRule",
    "CSSPageRule",
    "CSSPrimitiveValue",
    "CSSRule",
    "CSSRuleList",
    "CSSStyleDeclaration",
    "CSSStyleRule",
    "CSSStyleSheet",
    "CSSSupportsRule",
    "CSSUnknownRule",
    "CSSValue",
    "CSSValueList",
    "CustomEvent",
    "DataChannel",
    "DataContainerEvent",
    "DataErrorEvent",
    "DataTransfer",
    "DesktopNotification",
    "DesktopNotificationCenter",
    "DeviceAcceleration",
    "DeviceLightEvent",
    "DeviceMotionEvent",
    "DeviceOrientationEvent",
    "DeviceProximityEvent",
    "DeviceRotationRate",
    "DeviceStorage",
    "DeviceStorageChangeEvent",
    "DeviceStorageCursor",
    "Document",
    "DocumentFragment",
    "DocumentTouch",
    "DocumentType",
    "DocumentXBL",
    "DOMCursor",
    "DOMError",
    "DOMException",
    "DOMImplementation",
    "DOMRequest",
    "DOMSettableTokenList",
    "DOMStringList",
    "DOMStringMap",
    "DOMTokenList",
    "DOMTransactionEvent",
    "DragEvent",
    "Element",
    "ElementCSSInlineStyle",
    "ElementReplaceEvent",
    "ElementTimeControl",
    "Event",
    "EventListener",
    "EventListenerInfo",
    "EventSource",
    "EventTarget",
    "File",
    "FileHandle",
    "FileList",
    "FileReader",
    "FileRequest",
    "FocusEvent",
    "FontFace",
    "FontFaceList",
    "FormData",
    "Gamepad",
    "GamepadAxisMoveEvent",
    "GamepadButtonEvent",
    "GamepadEvent",
    "GeoGeolocation",
    "GeoPosition",
    "GeoPositionCallback",
    "GeoPositionCoords",
    "GeoPositionError",
    "GeoPositionErrorCallback",
    "GetUserMediaErrorCallback",
    "GetUserMediaSuccessCallback",
    "GlobalObjectConstructor",
    "GlobalPropertyInitializer",
    "HashChangeEvent",
    "History",
    "HTMLAnchorElement",
    "HTMLAppletElement",
    "HTMLAreaElement",
    "HTMLAudioElement",
    "HTMLBaseElement",
    "HTMLBodyElement",
    "HTMLBRElement",
    "HTMLButtonElement",
    "HTMLByteRanges",
    "HTMLCanvasElement",
    "HTMLCollection",
    "HTMLCommandElement",
    "HTMLDataListElement",
    "HTMLDirectoryElement",
    "HTMLDivElement",
    "HTMLDListElement",
    "HTMLDocument",
    "HTMLElement",
    "HTMLEmbedElement",
    "HTMLFieldSetElement",
    "HTMLFontElement",
    "HTMLFormElement",
    "HTMLFrameElement",
    "HTMLFrameSetElement",
    "HTMLHeadElement",
    "HTMLHeadingElement",
    "HTMLHRElement",
    "HTMLHtmlElement",
    "HTMLIFrameElement",
    "HTMLImageElement",
    "HTMLInputElement",
    "HTMLLabelElement",
    "HTMLLegendElement",
    "HTMLLIElement",
    "HTMLLinkElement",
    "HTMLMapElement",
    "HTMLMediaElement",
    "HTMLMenuElement",
    "HTMLMenuItemElement",
    "HTMLMetaElement",
    "HTMLMeterElement",
    "HTMLModElement",
    "HTMLObjectElement",
    "HTMLOListElement",
    "HTMLOptGroupElement",
    "HTMLOptionElement",
    "HTMLOptionsCollection",
    "HTMLOutputElement",
    "HTMLParagraphElement",
    "HTMLParamElement",
    "HTMLPreElement",
    "HTMLProgressElement",
    "HTMLPropertiesCollection",
    "HTMLQuoteElement",
    "HTMLScriptElement",
    "HTMLSelectElement",
    "HTMLSourceElement",
    "HTMLStyleElement",
    "HTMLTableCaptionElement",
    "HTMLTableCellElement",
    "HTMLTableColElement",
    "HTMLTableElement",
    "HTMLTableRowElement",
    "HTMLTableSectionElement",
    "HTMLTextAreaElement",
    "HTMLTitleElement",
    "HTMLUListElement",
    "HTMLUnknownElement",
    "HTMLVideoElement",
    "IDBCursor",
    "IDBCursorWithValue",
    "IDBDatabase",
    "IDBFactory",
    "IDBIndex",
    "IDBKeyRange",
    "IDBObjectStore",
    "IDBOpenDBRequest",
    "IDBRequest",
    "IDBTransaction",
    "IDBVersionChangeEvent",
    "ImageData",
    "ImageDocument",
    "JSON",
    "JSWindow",
    "KeyEvent",
    "LinkStyle",
    "LoadStatus",
    "LocalMediaStream",
    "Location",
    "LockedFile",
    "LSProgressEvent",
    "MediaError",
    "MediaList",
    "MediaQueryList",
    "MediaQueryListListener",
    "MediaStream",
    "MessageEvent",
    "MimeType",
    "MimeTypeArray",
    "ModalContentWindow",
    "MouseEvent",
    "MouseScrollEvent",
    "MozAlarmsManager",
    "MozApplicationEvent",
    "MozBlobBuilder",
    "MozBrowserFrame",
    "MozCanvasPrintState",
    "MozConnection",
    "MozContactChangeEvent",
    "MozCSSKeyframeRule",
    "MozCSSKeyframesRule",
    "MozMmsEvent",
    "MozMmsMessage",
    "MozMobileCellInfo",
    "MozMobileConnectionInfo",
    "MozMobileMessageManager",
    "MozMobileMessageThread",
    "MozMobileNetworkInfo",
    "MozNamedAttrMap",
    "MozNavigatorMobileMessage",
    "MozNavigatorNetwork",
    "MozNavigatorSms",
    "MozNavigatorTime",
    "MozNetworkStats",
    "MozNetworkStatsData",
    "MozNetworkStatsManager",
    "MozPowerManager",
    "MozSettingsEvent",
    "MozSmsEvent",
    "MozSmsFilter",
    "MozSmsManager",
    "MozSmsMessage",
    "MozSmsSegmentInfo",
    "MozTimeManager",
    "MozTouchEvent",
    "MozWakeLock",
    "MozWakeLockListener",
    "MutationEvent",
    "MutationObserver",
    "MutationRecord",
    "Navigator",
    "NavigatorCamera",
    "NavigatorDesktopNotification",
    "NavigatorDeviceStorage",
    "NavigatorGeolocation",
    "NavigatorUserMedia",
    "Node",
    "NodeFilter",
    "NodeIterator",
    "NodeList",
    "NodeSelector",
    "NotifyAudioAvailableEvent",
    "NotifyPaintEvent",
    "NSEditableElement",
    "NSEvent",
    "NSRGBAColor",
    "NSXPathExpression",
    "OfflineResourceList",
    "OpenWindowEventDetail",
    "PageTransitionEvent",
    "PaintRequest",
    "PaintRequestList",
    "Parser",
    "ParserJS",
    "PaymentRequestInfo",
    "Performance",
    "PerformanceNavigation",
    "PerformanceTiming",
    "PermissionSettings",
    "Pkcs11",
    "Plugin",
    "PluginArray",
    "PopStateEvent",
    "PopupBlockedEvent",
    "ProcessingInstruction",
    "ProgressEvent",
    "PropertyNodeList",
    "PushManager",
    "Range",
    "Rect",
    "RequestService",
    "RGBColor",
    "RTCIceCandidate",
    "RTCPeerConnection",
    "RTCSessionDescription",
    "Screen",
    "ScrollAreaEvent",
    "Selection",
    "Serializer",
    "SettingsLock",
    "SettingsManager",
    "SimpleGestureEvent",
    "SmartCardEvent",
    "SpeechRecognitionError",
    "SpeechRecognitionEvent",
    "SpeechSynthesisEvent",
    "Storage",
    "StorageEvent",
    "StorageIndexedDB",
    "StorageItem",
    "StorageManager",
    "StorageObsolete",
    "StyleRuleChangeEvent",
    "StyleSheet",
    "StyleSheetApplicableStateChangeEvent",
    "StyleSheetChangeEvent",
    "StyleSheetList",
    "SVGAElement",
    "SVGAltGlyphElement",
    "SVGAngle",
    "SVGAnimatedAngle",
    "SVGAnimatedBoolean",
    "SVGAnimatedEnumeration",
    "SVGAnimatedInteger",
    "SVGAnimatedLength",
    "SVGAnimatedLengthList",
    "SVGAnimatedNumber",
    "SVGAnimatedNumberList",
    "SVGAnimatedPathData",
    "SVGAnimatedPoints",
    "SVGAnimatedPreserveAspectRatio",
    "SVGAnimatedRect",
    "SVGAnimatedString",
    "SVGAnimatedTransformList",
    "SVGAnimateElement",
    "SVGAnimateMotionElement",
    "SVGAnimateTransformElement",
    "SVGAnimationElement",
    "SVGCircleElement",
    "SVGClipPathElement",
    "SVGComponentTransferFunctionElement",
    "SVGDefsElement",
    "SVGDescElement",
    "SVGDocument",
    "SVGElement",
    "SVGEllipseElement",
    "SVGEvent",
    "SVGFEBlendElement",
    "SVGFEColorMatrixElement",
    "SVGFEComponentTransferElement",
    "SVGFECompositeElement",
    "SVGFEConvolveMatrixElement",
    "SVGFEDiffuseLightingElement",
    "SVGFEDisplacementMapElement",
    "SVGFEDistantLightElement",
    "SVGFEFloodElement",
    "SVGFEFuncAElement",
    "SVGFEFuncBElement",
    "SVGFEFuncGElement",
    "SVGFEFuncRElement",
    "SVGFEGaussianBlurElement",
    "SVGFEImageElement",
    "SVGFEMergeElement",
    "SVGFEMergeNodeElement",
    "SVGFEMorphologyElement",
    "SVGFEOffsetElement",
    "SVGFEPointLightElement",
    "SVGFESpecularLightingElement",
    "SVGFESpotLightElement",
    "SVGFETileElement",
    "SVGFETurbulenceElement",
    "SVGFilterElement",
    "SVGFilterPrimitiveStandardAttributes",
    "SVGFitToViewBox",
    "SVGForeignObjectElement",
    "SVGGElement",
    "SVGGradientElement",
    "SVGImageElement",
    "SVGLength",
    "SVGLengthList",
    "SVGLinearGradientElement",
    "SVGLineElement",
    "SVGLocatable",
    "SVGMarkerElement",
    "SVGMaskElement",
    "SVGMatrix",
    "SVGMetadataElement",
    "SVGMpathElement",
    "SVGNumber",
    "SVGNumberList",
    "SVGPathElement",
    "SVGPathSeg",
    "SVGPathSegArcAbs",
    "SVGPathSegArcRel",
    "SVGPathSegClosePath",
    "SVGPathSegCurvetoCubicAbs",
    "SVGPathSegCurvetoCubicRel",
    "SVGPathSegCurvetoCubicSmoothAbs",
    "SVGPathSegCurvetoCubicSmoothRel",
    "SVGPathSegCurvetoQuadraticAbs",
    "SVGPathSegCurvetoQuadraticRel",
    "SVGPathSegCurvetoQuadraticSmoothAbs",
    "SVGPathSegCurvetoQuadraticSmoothRel",
    "SVGPathSegLinetoAbs",
    "SVGPathSegLinetoHorizontalAbs",
    "SVGPathSegLinetoHorizontalRel",
    "SVGPathSegLinetoRel",
    "SVGPathSegLinetoVerticalAbs",
    "SVGPathSegLinetoVerticalRel",
    "SVGPathSegList",
    "SVGPathSegMovetoAbs",
    "SVGPathSegMovetoRel",
    "SVGPatternElement",
    "SVGPoint",
    "SVGPointList",
    "SVGPolygonElement",
    "SVGPolylineElement",
    "SVGPreserveAspectRatio",
    "SVGRadialGradientElement",
    "SVGRect",
    "SVGRectElement",
    "SVGScriptElement",
    "SVGSetElement",
    "SVGStopElement",
    "SVGStringList",
    "SVGStylable",
    "SVGStyleElement",
    "SVGSVGElement",
    "SVGSwitchElement",
    "SVGSymbolElement",
    "SVGTests",
    "SVGTextContentElement",
    "SVGTextElement",
    "SVGTextPathElement",
    "SVGTextPositioningElement",
    "SVGTitleElement",
    "SVGTransform",
    "SVGTransformable",
    "SVGTransformList",
    "SVGTSpanElement",
    "SVGUnitTypes",
    "SVGURIReference",
    "SVGUseElement",
    "SVGViewElement",
    "SVGViewSpec",
    "SVGZoomAndPan",
    "SVGZoomEvent",
    "TCPSocket",
    "Text",
    "TextMetrics",
    "TimeEvent",
    "TimeRanges",
    "ToString",
    "Touch",
    "TouchEvent",
    "TouchList",
    "TransitionEvent",
    "TreeColumn",
    "TreeColumns",
    "TreeContentView",
    "TreeSelection",
    "TreeWalker",
    "UIEvent",
    "UndoManager",
    "URL",
    "UserDataHandler",
    "UserProximityEvent",
    "USSDReceivedEvent",
    "ValidityState",
    "WebGLRenderingContext",
    "WebSocket",
    "WheelEvent",
    "Window",
    "WindowCollection",
    "WindowInternal",
    "WindowPerformance",
    "WindowUtils",
    "XMLDocument",
    "XMLHttpRequest",
    "XMLHttpRequestEventTarget",
    "XMLHttpRequestUpload",
    "XPathEvaluator",
    "XPathExpression",
    "XPathNamespace",
    "XPathNSResolver",
    "XPathResult",
    "XSLTProcessor",
    "XULButtonElement",
    "XULCheckboxElement",
    "XULCommandDispatcher",
    "XULCommandEvent",
    "XULContainerElement",
    "XULContainerItemElement",
    "XULControlElement",
    "XULDescriptionElement",
    "XULDocument",
    "XULElement",
    "XULImageElement",
    "XULLabeledControlElement",
    "XULLabelElement",
    "XULMenuListElement",
    "XULMultiSelectControlElement",
    "XULPopupElement",
    "XULRelatedElement",
    "XULSelectControlElement",
    "XULSelectControlItemElement",
    "XULTemplateBuilder",
    "XULTextBoxElement",
    "XULTreeBuilder",
    "XULTreeElement",
  ]

var populateLists = function() {
	var seenList = [];
	var unseenList = [];
	var unexpectedList = [];
	var allObjects = Object.getOwnPropertyNames(window);
	for(var i in allObjects) {
	    name = allObjects[i];
	    if(interfaceNamesInGlobalScope.indexOf(name) >= 0 ||
	       objectsIDontCareAbout.indexOf(name) >= 0){
	    	seenList.push(name);
	    }
	    else {
	    	unexpectedList.push(name);
	    }
	}
	for(var i in interfaceNamesInGlobalScope) {
		name = interfaceNamesInGlobalScope[i];
		if(allObjects.indexOf(name) < 0) {
			unseenList.push(name);
		}
	}

	unseenNames = '<ol>';
	for(var i in unseenList) {
		unseenNames += '<li>' + unseenList[i] + '</li>\n';
	}
	unseenNames += '</ol>';

	seenNames = '<ol>';
	for(var i in seenList) {
		seenNames += '<li>' + seenList[i] + '</li>\n';
	}
	seenNames += '</ol>';

	unexpectedNames = '<ol>';
	for(var i in unexpectedList) {
		unexpectedNames += '<li>' + unexpectedList[i] + '</li>\n';
	}
	unexpectedNames += '</ol>';

	document.getElementById('unseenNames').innerHTML = unseenNames;
	document.getElementById('seenNames').innerHTML = seenNames;
	document.getElementById('unexpectedNames').innerHTML = unexpectedNames;
}
setTimeout(populateLists, 1000);
</script>

</body>
</html>