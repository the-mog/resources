'''

TRANSMITTER
sophia.re
07/06/15

'''

from time import time,sleep
import os

# takes a binary string as input
def send (Message, roundLength):
        for x in Message:
                # Run a single busy loop to represent a 0
                if( x == '0'):
                        print('sending', x)
                        # change the time of this busy loop to match receiver round length
                        start_time = time()
                        end_time = time() + roundLength #this number is loop time in seconds
                        while( start_time < end_time):
                                start_time = time() #do nothing
                else:
                        # send a 'hi' bit in a given time frame
			# by reducing the received out of order executions
			# this is done using the sender exe
			print('sending', x)
                        start_time = time()
                        end_time = time() + roundLength
                        while( start_time < end_time):
                                os.system("C:\\CPUSender.exe")
				# do nothing until sending c process terminates
                                start_time = time()


def main():
	# measured receiver time frame length in seconds - (for one bit)
        roundLength = 1.08 
        message = ''

	# enter binary string
        while( message != 'exit'):
                message = raw_input('Enter Binary String: ')
                start_t = time()
                if( message != 'exit'):
                        send(message,roundLength)
                print "\nTotal execution time: "
                print time() - start_t

if __name__ == "__main__":
        main()
